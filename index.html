<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centro de Comando Estrat√©gico de Conte√∫do</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .spinner, .spinner-sm { border-radius: 50%; animation: spin 1s ease infinite; border: 4px solid rgba(0, 0, 0, 0.1); }
        .spinner { width: 36px; height: 36px; border-left-color: #059669; }
        .spinner-sm { width: 20px; height: 20px; border-left-color: #fff; border-width: 2px;}
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .tab-button { padding: 10px 20px; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.2s; }
        .tab-button.active { border-bottom-color: #10b981; color: #059669; font-weight: 600; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        #editor-modal-content { max-height: 80vh; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Centro de Comando Estrat√©gico de Conte√∫do</h1>
            <p class="text-gray-600 mt-2">A su√≠te definitiva para pesquisar, analisar, criar e monetizar.</p>
        </header>

        <main>
            <!-- Configura√ß√µes de API -->
            <details class="bg-white p-4 rounded-lg shadow-md mb-8">
                <summary class="font-semibold cursor-pointer text-lg">üîë Configura√ß√µes de API (Essencial)</summary>
                <div class="mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 border-t pt-4">
                    <div><label for="google-search-key" class="block text-sm font-medium">Google Search Key</label><input type="password" id="google-search-key" class="w-full p-2 border rounded-md"></div>
                    <div><label for="google-cx-id" class="block text-sm font-medium">Google Search CX ID</label><input type="password" id="google-cx-id" class="w-full p-2 border rounded-md"></div>
                    <div><label for="gemini-key" class="block text-sm font-medium">Google AI Key</label><input type="password" id="gemini-key" class="w-full p-2 border rounded-md"></div>
                    <div><label for="extractor-key" class="block text-sm font-medium">ExtractorAPI Key</label><input type="password" id="extractor-key" class="w-full p-2 border rounded-md"></div>
                    <div><label for="youtube-key" class="block text-sm font-medium">YouTube API Key</label><input type="password" id="youtube-key" class="w-full p-2 border rounded-md"></div>
                </div>
            </details>

            <!-- Abas de Ferramentas -->
            <div class="bg-white rounded-lg shadow-md">
                <div class="border-b border-gray-200">
                    <nav class="-mb-px flex gap-6 px-6" aria-label="Tabs">
                        <button class="tab-button active" onclick="changeTab(event, 'market-research')">Pesquisa de Mercado</button>
                        <button class="tab-button" onclick="changeTab(event, 'community-analysis')">An√°lise de Comunidades</button>
                        <button class="tab-button" onclick="changeTab(event, 'affiliate-analysis')">Oportunidades de Afilia√ß√£o</button>
                    </nav>
                </div>

                <!-- Conte√∫do da Aba: Pesquisa de Mercado -->
                <div id="market-research" class="tab-content active p-6">
                    <div class="flex flex-col md:flex-row gap-4">
                        <input type="text" id="main-keyword-input" placeholder="Digite um nicho ou palavra-chave..." class="flex-grow p-3 border border-gray-300 rounded-md">
                        <button id="analyze-keyword-button" class="bg-indigo-600 text-white font-semibold py-3 px-4 rounded-md hover:bg-indigo-700 flex-shrink-0">üîç Analisar Palavra-Chave</button>
                    </div>
                    <div class="mt-6 border-t pt-4">
                        <p class="text-center text-gray-600 mb-4 font-semibold">Refinar Busca de Conte√∫do</p>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div><label for="platform-filter" class="block font-bold text-gray-800 mb-2 text-sm">Plataforma</label><select id="platform-filter" class="w-full p-3 border border-gray-300 rounded-md"><option value="">Busca por navega√ß√£o do Google</option><option value="youtube.com">YouTube</option><option value="pinterest.com">Pinterest</option><option value="instagram.com">Instagram</option></select></div>
                            <div><label for="country-filter" class="block font-bold text-gray-800 mb-2 text-sm">Pa√≠s</label><select id="country-filter" class="w-full p-3 border border-gray-300 rounded-md"><option value="">Qualquer</option><option value="countryBR">Brasil</option><option value="countryUS">EUA</option><option value="countryPT">Portugal</option></select></div>
                            <div><label for="date-filter" class="block font-bold text-gray-800 mb-2 text-sm">Data</label><select id="date-filter" class="w-full p-3 border border-gray-300 rounded-md"><option value="">Qualquer</option><option value="d1">√öltimas 24h</option><option value="w1">√öltima semana</option><option value="m1">√öltimo m√™s</option></select></div>
                        </div>
                    </div>
                    <div class="mt-6 text-center">
                        <button id="search-button" class="w-full md:w-1/2 bg-emerald-600 text-white font-semibold py-3 px-6 rounded-md hover:bg-emerald-700">üí° Buscar Conte√∫do</button>
                    </div>
                </div>

                <!-- Conte√∫do da Aba: An√°lise de Comunidades -->
                <div id="community-analysis" class="tab-content p-6">
                     <h2 class="text-2xl font-bold mb-4">Analisador de Comunidades (Reddit)</h2>
                     <div class="flex flex-col md:flex-row gap-4">
                        <input type="text" id="reddit-keyword-input" placeholder="Digite um nicho para encontrar comunidades..." class="flex-grow p-3 border border-gray-300 rounded-md">
                        <button id="reddit-search-button" class="bg-orange-500 text-white font-semibold py-3 px-4 rounded-md hover:bg-orange-600 flex-shrink-0">üó£Ô∏è Buscar no Reddit</button>
                    </div>
                </div>
                
                <!-- Conte√∫do da Aba: Oportunidades de Afilia√ß√£o -->
                <div id="affiliate-analysis" class="tab-content p-6">
                    <h2 class="text-2xl font-bold mb-4">Analisador de Produtos (Amazon)</h2>
                     <div class="flex flex-col md:flex-row gap-4">
                        <input type="text" id="amazon-keyword-input" placeholder="Digite um produto ou nicho..." class="flex-grow p-3 border border-gray-300 rounded-md">
                        <button id="amazon-search-button" class="bg-yellow-500 text-gray-900 font-semibold py-3 px-4 rounded-md hover:bg-yellow-600 flex-shrink-0">üí∞ Buscar na Amazon</button>
                    </div>
                    <p class="text-xs text-gray-500 mt-2">Nota: A API da Amazon √© complexa e requer uma conta de associado aprovada.</p>
                </div>
            </div>

            <!-- Se√ß√£o de Resultados (Comum a todas as abas) -->
            <div id="loading-spinner" class="hidden justify-center items-center my-10"><div class="spinner"></div></div>
            <div id="results-title" class="text-2xl font-bold text-gray-800 mt-10 mb-2 text-center hidden"></div>
            <div id="results-subtitle" class="text-sm text-gray-600 mb-6 text-center hidden"></div>
            <div id="error-message" class="hidden text-center bg-red-100 text-red-700 p-4 rounded-md my-6"></div>
            <div id="results-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            <div id="pagination-container" class="mt-10 flex justify-center items-center gap-4"></div>
        </main>
    </div>

    <!-- Modal para An√°lise de V√≠deo e outras IAs -->
    <div id="ai-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-2xl">
            <div class="p-6 border-b flex justify-between items-center">
                <h2 id="ai-modal-title" class="text-2xl font-bold">An√°lise com IA</h2>
                <button id="close-ai-modal-button" class="text-2xl font-bold hover:text-red-500">&times;</button>
            </div>
            <div class="p-6 overflow-y-auto" style="max-height: 70vh;">
                <div id="ai-modal-spinner" class="flex justify-center items-center h-48"><div class="spinner"></div></div>
                <div id="ai-modal-content" class="text-gray-700 space-y-4"></div>
            </div>
        </div>
    </div>
    
    <!-- Modal do Editor SEO -->
    <div id="editor-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50"><div class="bg-white rounded-lg shadow-2xl w-full max-w-5xl"><div class="p-6 border-b flex justify-between items-center"><h2 class="text-2xl font-bold">Editor e Otimizador SEO</h2><button id="close-editor-button" class="text-2xl font-bold hover:text-red-500">&times;</button></div><div id="editor-modal-content" class="p-6 overflow-y-auto"><div id="editor-spinner" class="flex justify-center items-center h-64"><div class="spinner"></div></div><div id="editor-content" class="hidden"><div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div><label class="block font-bold mb-1">T√≠tulo</label><input id="editor-title" type="text" class="w-full p-2 border rounded-md mb-4"><label class="block font-bold mb-1">Conte√∫do do Artigo</label><textarea id="editor-text" rows="15" class="w-full p-2 border rounded-md"></textarea><button id="rewrite-button" class="w-full mt-2 bg-teal-500 text-white font-semibold p-2 rounded-md hover:bg-teal-600 flex items-center justify-center gap-2">‚úçÔ∏è Reescrever com IA <span id="rewrite-spinner" class="hidden spinner-sm"></span></button></div><div class="bg-gray-50 p-4 rounded-lg"><h3 class="font-bold text-lg mb-4">An√°lise SEO com IA</h3><button id="analyze-seo-button" class="w-full bg-purple-600 text-white font-semibold p-3 rounded-md hover:bg-purple-700 flex items-center justify-center gap-2">Analisar SEO do meu texto <span id="seo-spinner" class="hidden spinner-sm"></span></button><div id="seo-results" class="mt-4 text-sm space-y-3"></div></div></div></div></div></div></div>

    <script>
        // --- ELEMENTOS E ESTADO ---
        const el = {
            googleSearchKey: document.getElementById('google-search-key'), googleCxId: document.getElementById('google-cx-id'), geminiKey: document.getElementById('gemini-key'), extractorKey: document.getElementById('extractor-key'), youtubeKey: document.getElementById('youtube-key'),
            mainKeywordInput: document.getElementById('main-keyword-input'), analyzeKeywordButton: document.getElementById('analyze-keyword-button'),
            platformFilter: document.getElementById('platform-filter'), countryFilter: document.getElementById('country-filter'), dateFilter: document.getElementById('date-filter'),
            searchButton: document.getElementById('search-button'),
            redditKeywordInput: document.getElementById('reddit-keyword-input'), redditSearchButton: document.getElementById('reddit-search-button'),
            amazonKeywordInput: document.getElementById('amazon-keyword-input'), amazonSearchButton: document.getElementById('amazon-search-button'),
            resultsContainer: document.getElementById('results-container'), loadingSpinner: document.getElementById('loading-spinner'), errorMessage: document.getElementById('error-message'), resultsTitle: document.getElementById('results-title'), resultsSubtitle: document.getElementById('results-subtitle'), paginationContainer: document.getElementById('pagination-container'),
            aiModal: document.getElementById('ai-modal'), aiModalTitle: document.getElementById('ai-modal-title'), aiModalContent: document.getElementById('ai-modal-content'), aiModalSpinner: document.getElementById('ai-modal-spinner'), closeAiModalButton: document.getElementById('close-ai-modal-button'),
            editorModal: document.getElementById('editor-modal'), closeEditorButton: document.getElementById('close-editor-button'), editorSpinner: document.getElementById('editor-spinner'), editorContent: document.getElementById('editor-content'),
            editorTitle: document.getElementById('editor-title'), editorText: document.getElementById('editor-text'), rewriteButton: document.getElementById('rewrite-button'), rewriteSpinner: document.getElementById('rewrite-spinner'),
            analyzeSeoButton: document.getElementById('analyze-seo-button'), seoSpinner: document.getElementById('seo-spinner'), seoResults: document.getElementById('seo-results'),
        };

        let state = { currentQuery: '', totalResults: 0, currentPage: 1 };

        // --- L√ìGICA DE ABAS ---
        function changeTab(event, tabName) {
            document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(tb => tb.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.currentTarget.classList.add('active');
            el.resultsContainer.innerHTML = '';
            el.resultsTitle.style.display = 'none';
            el.resultsSubtitle.style.display = 'none';
            el.paginationContainer.innerHTML = '';
        }

        // --- L√ìGICA DE BUSCA PRINCIPAL ---
        function startNewSearch() {
            const keyword = el.mainKeywordInput.value.trim();
            if (!keyword) { displayError("Por favor, digite um nicho ou palavra-chave para buscar."); return; }
            const platform = el.platformFilter.value;
            const platformQuery = platform ? `site:${platform}` : '';
            state.currentQuery = `${platformQuery} "${keyword}"`.trim();
            state.currentPage = 1;
            fetchAndDisplayPage(state.currentPage);
        }

        async function fetchAndDisplayPage(page) {
            const apiKey = el.googleSearchKey.value.trim();
            const cxId = el.googleCxId.value.trim();
            if (!apiKey || !cxId) { displayError("Configure sua API Key e CX ID do Google Search."); return; }

            setLoadingState(true);
            const startIndex = (page - 1) * 10 + 1;
            let apiUrl = `https://www.googleapis.com/customsearch/v1?key=${apiKey}&cx=${cxId}&q=${encodeURIComponent(state.currentQuery)}&num=10&start=${startIndex}`;
            const dateRestrict = el.dateFilter.value;
            const countryRestrict = el.countryFilter.value;
            if (dateRestrict) apiUrl += `&dateRestrict=${dateRestrict}`;
            if (countryRestrict) apiUrl += `&cr=${countryRestrict}`;

            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                if (data.error) throw new Error(data.error.message);
                if (page === 1) state.totalResults = data.searchInformation ? data.searchInformation.totalResults : 0;
                el.resultsTitle.textContent = `Resultados para: "${state.currentQuery.trim()}"`;
                el.resultsTitle.style.display = 'block';
                state.currentPage = page;
                displayGoogleResults(data.items || []);
                setupPagination();
            } catch (error) {
                displayError(`Erro ao buscar: ${error.message}`);
            } finally {
                setLoadingState(false);
            }
        }

        function displayGoogleResults(items) {
            el.resultsContainer.innerHTML = '';
            if (items.length === 0) { displayError("Nenhum resultado encontrado."); el.resultsTitle.style.display = 'none'; return; }
            el.resultsSubtitle.textContent = `Aproximadamente ${state.totalResults} resultados encontrados.`;
            el.resultsSubtitle.style.display = 'block';

            items.forEach(item => {
                let imageUrl = 'https://placehold.co/600x400/e2e8f0/4a5568?text=Sem+Imagem';
                if (item.pagemap?.cse_image?.length > 0) imageUrl = item.pagemap.cse_image[0].src;
                const card = document.createElement('div');
                card.className = "bg-white rounded-lg shadow-md overflow-hidden flex flex-col";
                
                let buttonsHtml = `<a href="${item.link}" target="_blank" rel="noopener noreferrer" class="text-center bg-gray-800 text-white font-semibold py-2 px-3 rounded-md hover:bg-gray-900">Visitar</a>`;
                if(item.link.includes("youtube.com/watch?v=")) {
                    const videoId = new URL(item.link).searchParams.get('v');
                    buttonsHtml += `<button data-video-id="${videoId}" class="analyze-video-button text-center bg-red-600 text-white font-semibold py-2 px-3 rounded-md hover:bg-red-700">üé• Analisar</button>`;
                } else {
                    buttonsHtml += `<button class="extract-button text-center bg-teal-600 text-white font-semibold py-2 px-3 rounded-md hover:bg-teal-700">üìñ Extrair</button>`;
                }
                buttonsHtml += `<button onclick="window.open('https://ahrefs.com/backlink-checker?url=${encodeURIComponent(item.link)}', '_blank')" class="text-center bg-indigo-600 text-white font-semibold py-2 px-3 rounded-md hover:bg-indigo-700">üîó Backlinks</button>`;

                card.innerHTML = `<img src="${imageUrl}" class="w-full h-48 object-cover"><div class="p-4 flex flex-col flex-grow"><h3 class="text-lg font-bold mb-2">${item.title}</h3><p class="text-sm text-gray-700 mb-4 flex-grow">${item.snippet || 'Descri√ß√£o n√£o dispon√≠vel.'}</p><div class="mt-auto grid grid-cols-3 gap-2 text-sm">${buttonsHtml}</div></div>`;
                
                const extractButton = card.querySelector('.extract-button');
                if (extractButton) extractButton.addEventListener('click', () => openSeoEditor(item.link));
                
                const analyzeVideoButton = card.querySelector('.analyze-video-button');
                if(analyzeVideoButton) analyzeVideoButton.addEventListener('click', (e) => analyzeYouTubeVideo(e.currentTarget.dataset.videoId));

                el.resultsContainer.appendChild(card);
            });
        }
        
        // --- L√ìGICA DE AN√ÅLISE DE COMUNIDADES (REDDIT) ---
        async function searchReddit() {
            const keyword = el.redditKeywordInput.value.trim();
            if(!keyword) { displayError("Digite um nicho para buscar no Reddit."); return; }
            setLoadingState(true);
            el.resultsTitle.textContent = `Posts Populares no Reddit sobre: "${keyword}"`;
            el.resultsTitle.style.display = 'block';
            try {
                const response = await fetch(`https://www.reddit.com/search.json?q=${encodeURIComponent(keyword)}&sort=relevance&t=all`);
                const data = await response.json();
                displayRedditResults(data.data.children.map(p => p.data));
            } catch (error) {
                displayError("Erro ao buscar no Reddit.");
            } finally {
                setLoadingState(false);
            }
        }

        function displayRedditResults(posts) {
            el.resultsContainer.innerHTML = '';
            if (!posts || posts.length === 0) { displayError("Nenhum post encontrado no Reddit."); el.resultsTitle.style.display = 'none'; return; }
            posts.slice(0, 12).forEach(post => {
                const card = document.createElement('div');
                card.className = "bg-white rounded-lg shadow-md p-4 flex flex-col";
                card.innerHTML = `<p class="text-xs text-orange-500 font-bold">r/${post.subreddit}</p><h3 class="text-md font-bold my-2 flex-grow">${post.title}</h3><div class="text-xs text-gray-500 mt-auto flex justify-between"><span>‚¨ÜÔ∏è ${post.score} Upvotes</span><span>üí¨ ${post.num_comments} Coment√°rios</span></div><a href="https://reddit.com${post.permalink}" target="_blank" rel="noopener noreferrer" class="mt-3 text-center w-full bg-gray-800 text-white font-semibold py-2 px-4 rounded-md hover:bg-gray-900 text-sm">Ver Post</a>`;
                el.resultsContainer.appendChild(card);
            });
        }

        // --- L√ìGICA DE AN√ÅLISE DE V√çDEO (YOUTUBE) ---
        async function analyzeYouTubeVideo(videoId) {
            const youtubeKey = el.youtubeKey.value.trim();
            if (!youtubeKey) { displayError("Configure sua API Key do YouTube."); return; }
            openAiModal("An√°lise de V√≠deo do YouTube");
            try {
                const apiUrl = `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&id=${videoId}&key=${youtubeKey}`;
                const response = await fetch(apiUrl);
                const data = await response.json();
                if (!data.items || data.items.length === 0) throw new Error("V√≠deo n√£o encontrado.");
                const video = data.items[0];
                const { title, description } = video.snippet;
                const { viewCount, likeCount, commentCount } = video.statistics;
                const geminiKey = el.geminiKey.value.trim();
                if (!geminiKey) {
                    el.aiModalContent.innerHTML = `<p class="text-red-500">API Key do Gemini n√£o configurada para resumir.</p>`;
                    return;
                }
                const prompt = `Fa√ßa um resumo conciso do seguinte v√≠deo do YouTube e liste seus 5 principais t√≥picos. T√≠tulo: "${title}". Descri√ß√£o: "${description.substring(0, 1000)}".`;
                const summary = await callGeminiAPI(prompt);
                el.aiModalContent.innerHTML = `<h3 class="font-bold text-lg">${title}</h3><div class="flex gap-4 text-sm text-gray-600 my-2"><span>üëÅÔ∏è ${parseInt(viewCount).toLocaleString()} views</span><span>üëç ${parseInt(likeCount).toLocaleString()} likes</span><span>üí¨ ${parseInt(commentCount).toLocaleString()} comments</span></div><div class="border-t pt-4 mt-4"><h4 class="font-bold">Resumo e T√≥picos (IA):</h4><p>${summary.replace(/\n/g, '<br>')}</p></div>`;
            } catch(error) {
                el.aiModalContent.innerHTML = `<p class="text-red-500">Erro ao analisar v√≠deo: ${error.message}</p>`;
            } finally {
                el.aiModalSpinner.style.display = 'none';
            }
        }
        
        // --- L√ìGICA DO EDITOR SEO ---
        async function openSeoEditor(url) {
            el.editorModal.style.display = 'flex';
            el.editorContent.style.display = 'none';
            el.editorSpinner.style.display = 'flex';
            el.seoResults.innerHTML = '';
            const extractorKey = el.extractorKey.value.trim();
            if (!extractorKey) { displayErrorInModal("Configure sua API Key do ExtractorAPI."); return; }
            try {
                const apiUrl = `https://extractorapi.com/api/v1/extractor/?apikey=${extractorKey}&url=${encodeURIComponent(url)}`;
                const response = await fetch(apiUrl);
                const data = await response.json();
                if (data.error) throw new Error(data.error);
                el.editorTitle.value = data.title || '';
                el.editorText.value = data.text || '';
                el.editorSpinner.style.display = 'none';
                el.editorContent.style.display = 'block';
            } catch (error) { displayErrorInModal(`Erro ao extrair: ${error.message}`); }
        }
        function closeEditor() { el.editorModal.style.display = 'none'; }
        
        // --- FUN√á√ïES DE UI E INICIALIZA√á√ÉO ---
        function setupPagination() {
            el.paginationContainer.innerHTML = '';
            const totalPages = Math.min(Math.ceil(state.totalResults / 10), 10);
            if (totalPages <= 1) return;
            const prevButton = document.createElement('button'); prevButton.innerHTML = '&laquo;'; prevButton.className = 'pagination-button'; prevButton.disabled = state.currentPage === 1; prevButton.addEventListener('click', () => fetchAndDisplayPage(state.currentPage - 1)); el.paginationContainer.appendChild(prevButton);
            const pageIndicator = document.createElement('span'); pageIndicator.textContent = `P√°gina ${state.currentPage} de ${totalPages}`; pageIndicator.className = 'font-semibold text-gray-700 px-4'; el.paginationContainer.appendChild(pageIndicator);
            const nextButton = document.createElement('button'); nextButton.innerHTML = '&raquo;'; nextButton.className = 'pagination-button'; nextButton.disabled = state.currentPage === totalPages; nextButton.addEventListener('click', () => fetchAndDisplayPage(state.currentPage + 1)); el.paginationContainer.appendChild(nextButton);
        }
        function setLoadingState(isLoading) {
            el.loadingSpinner.style.display = isLoading ? 'flex' : 'none';
            if(isLoading) { el.errorMessage.style.display = 'none'; el.resultsContainer.innerHTML = ''; el.paginationContainer.innerHTML = ''; }
        }
        function displayError(message) { setLoadingState(false); el.errorMessage.textContent = message; el.errorMessage.style.display = 'block'; el.resultsTitle.style.display = 'none'; el.resultsSubtitle.style.display = 'none'; }
        function displayErrorInModal(message) { el.editorSpinner.style.display = 'none'; el.editorContent.innerHTML = `<p class="text-red-500 text-center">${message}</p>`; el.editorContent.style.display = 'block'; }
        function analyzeKeyword() {
            const keyword = el.mainKeywordInput.value.trim();
            if (!keyword) { alert("Por favor, digite uma palavra-chave para analisar."); return; }
            window.open(`https://trends.google.com/trends/explore?q=${encodeURIComponent(keyword)}`, '_blank');
            window.open(`https://app.neilpatel.com/en/ubersuggest/keyword_overview?keyword=${encodeURIComponent(keyword)}`, '_blank');
            window.open(`https://answerthepublic.com/search?query=${encodeURIComponent(keyword)}`, '_blank');
        }
        function openAiModal(title) {
            el.aiModalTitle.textContent = title;
            el.aiModal.style.display = 'flex';
            el.aiModalSpinner.style.display = 'flex';
            el.aiModalContent.innerHTML = '';
        }
        function closeAiModal() { el.aiModal.style.display = 'none'; }
        async function callGeminiAPI(prompt) {
            const geminiKey = el.geminiKey.value.trim();
            if (!geminiKey) { return "API Key do Gemini n√£o configurada."; }
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${geminiKey}`;
            const payload = { contents: [{ parts: [{ text: prompt }] }] };
            try {
                const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text || "Sem resposta da IA.";
            } catch (error) { return `Erro na IA: ${error.message}`; }
        }

        // --- EVENT LISTENERS ---
        el.searchButton.addEventListener('click', startNewSearch);
        el.analyzeKeywordButton.addEventListener('click', analyzeKeyword);
        el.redditSearchButton.addEventListener('click', searchReddit);
        el.amazonSearchButton.addEventListener('click', () => displayError("Funcionalidade da Amazon requer configura√ß√£o de backend devido √† complexidade da API."));
        el.closeAiModalButton.addEventListener('click', closeAiModal);
        el.closeEditorButton.addEventListener('click', closeEditor);
        // Adicionar outros listeners...
    </script>
</body>
</html>
